        <script>
        // Configuration - UPDATED
        const CONFIG = {
            SHEET_ID: '1RmpfjtzKsR-ZqeiHxya8z_hfyOw32H4KOBQ5X5nCj8g',
            // API_KEY removed - using public access
            RANGE: 'Sheet1!A:H'
        };

        let allData = [];
        let priorityChart = null;
        let categoryChart = null;

        // Initialize dashboard - UPDATED
        async function initializeDashboard() {
            console.log('ðŸš€ Initializing Telecom Intelligence Dashboard...');
            
            try {
                await loadData();
                updateMetrics();
                createCharts();
                displayNews();
                setupFilters();
                updateTimestamp();
                
                console.log('âœ… Dashboard initialized successfully');
            } catch (error) {
                console.error('âŒ Error initializing dashboard:', error);
                showError('Failed to load dashboard data. Please check the spreadsheet settings.');
                
                // Load sample data for demonstration
                loadSampleData();
            }
        }

        // Load data from Google Sheets - COMPLETELY REPLACED
        async function loadData() {
            try {
                console.log('ðŸ“Š Loading data from Google Sheets...');
                
                // Method 1: Using Google Sheets JSON API (no API key needed for public sheets)
                const url = `https://docs.google.com/spreadsheets/d/${CONFIG.SHEET_ID}/gviz/tq?tqx=out:json&tq=SELECT%20A,B,C,D,E,F,G,H&sheet=Sheet1`;
                
                const response = await fetch(url);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const text = await response.text();
                console.log('Raw response received');
                
                // Parse the Google Visualization API response
                const json = JSON.parse(text.substring(47, text.length - 2));
                
                if (!json.table || !json.table.rows) {
                    throw new Error('No data found in spreadsheet response');
                }
                
                // Process the data
                allData = json.table.rows.map((row, index) => {
                    const cells = row.c;
                    return {
                        id: index,
                        date: parseDate(cells[0] ? cells[0].v : ''),
                        source: cells[1] ? cells[1].v : '',
                        title: cells[2] ? cells[2].v : '',
                        category: cells[3] ? cells[3].v : '',
                        importance: cells[4] ? parseInt(cells[4].v) || 2 : 2,
                        summary: cells[5] ? cells[5].v : '',
                        keywords: cells[6] ? cells[6].v : '',
                        url: cells[7] ? cells[7].v : ''
                    };
                }).filter(item => item.title); // Remove empty rows
                
                console.log(`âœ… Loaded ${allData.length} intelligence items`);
                
            } catch (error) {
                console.error('âŒ Error loading data from Sheets:', error);
                
                // Try alternative method - CSV export
                try {
                    console.log('ðŸ”„ Trying alternative data loading method...');
                    await loadDataAlternative();
                } catch (altError) {
                    console.error('âŒ Alternative method also failed:', altError);
                    throw new Error('Could not load data from spreadsheet. Please make sure the sheet is published to the web.');
                }
            }
        }

        // Alternative data loading method - NEW FUNCTION
        async function loadDataAlternative() {
            const csvUrl = `https://docs.google.com/spreadsheets/d/${CONFIG.SHEET_ID}/export?format=csv&gid=0`;
            
            const response = await fetch(csvUrl);
            if (!response.ok) {
                throw new Error(`CSV export failed: ${response.status}`);
            }
            
            const csvText = await response.text();
            const lines = csvText.split('\n').filter(line => line.trim());
            
            if (lines.length < 2) {
                throw new Error('No data in CSV export');
            }
            
            // Skip header row
            allData = lines.slice(1).map((line, index) => {
                const columns = line.split(','); // Simple CSV parsing
                return {
                    id: index,
                    date: parseDate(columns[0] || ''),
                    source: columns[1] || '',
                    title: columns[2] || '',
                    category: columns[3] || '',
                    importance: parseInt(columns[4]) || 2,
                    summary: columns[5] || '',
                    keywords: columns[6] || '',
                    url: columns[7] || ''
                };
            }).filter(item => item.title);
            
            console.log(`âœ… Loaded ${allData.length} items via CSV`);
        }

        // Load sample data for demonstration - NEW FUNCTION
        function loadSampleData() {
            console.log('ðŸ“‹ Loading sample data for demonstration...');
            
            allData = [
                {
                    id: 1,
                    date: new Date(),
                    source: 'Telecom Analysis',
                    title: '5G Network Expansion Accelerates in European Markets',
                    category: '5G TECHNOLOGY',
                    importance: 4,
                    summary: 'Major telecom operators announce accelerated 5G deployment schedules across key European markets.',
                    keywords: '5G, Europe, deployment',
                    url: 'https://telecomanalysis.net'
                },
                {
                    id: 2,
                    date: new Date(Date.now() - 86400000),
                    source: 'Security Watch',
                    title: 'New Cybersecurity Threats Target Telecom Infrastructure',
                    category: 'CYBERSECURITY',
                    importance: 5,
                    summary: 'Emerging threats require immediate attention from network security teams.',
                    keywords: 'security, threats, infrastructure',
                    url: 'https://telecomanalysis.net'
                }
            ];
            
            updateMetrics();
            createCharts();
            displayNews();
            
            showError('Using sample data. Real data connection failed. Please make sure your Google Sheet is set to "Anyone with link can view".');
        }
